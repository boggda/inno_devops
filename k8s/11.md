# Lab 11

```
┌──(kali㉿kali)-[~/repos/inno_devops]
└─$ kubectl create secret generic db-user-pass \
    --from-literal=username=devuser \
    --from-literal=password='S!B\*d$zDsb='
secret/db-user-pass created
                                                                                                                     
┌──(kali㉿kali)-[~/repos/inno_devops]
└─$ kubectl get secret db-user-pass -o jsonpath='{.data}'
{"password":"UyFCXCpkJHpEc2I9","username":"ZGV2dXNlcg=="}
```

```
┌──(kali㉿kali)-[~/repos/inno_devops/k8s]
└─$ helm secrets upgrade python-app python-app/ -f secrets.yaml  
Release "python-app" has been upgraded. Happy Helming!
NAME: python-app
LAST DEPLOYED: Mon Nov 14 20:59:15 2022
NAMESPACE: default
STATUS: deployed
REVISION: 2
NOTES:
1. Get the application URL by running these commands:
     NOTE: It may take a few minutes for the LoadBalancer IP to be available.
           You can watch the status of by running 'kubectl get --namespace default svc -w python-app'
  export SERVICE_IP=$(kubectl get svc --namespace default python-app --template "{{ range (index .status.loadBalancer.ingress 0) }}{{.}}{{ end }}")
  echo http://$SERVICE_IP:80
removed 'secrets.yaml.dec'
```

```
┌──(kali㉿kali)-[~/repos/inno_devops/k8s]
└─$ minikube kubectl -- exec python-app-766cf49668-vvd29 -- printenv | grep MYSECRET
MYSECRET=MySuperPrivateSecret
```

```
┌──(kali㉿kali)-[~/repos/inno_devops/k8s]
└─$ minikube kubectl -- describe pods                                               
Name:         python-app-6b5bf7c796-xh9gb
Namespace:    default
Priority:     0
Node:         minikube/192.168.49.2
Start Time:   Mon, 14 Nov 2022 21:05:02 +0300
Labels:       app.kubernetes.io/instance=python-app
              app.kubernetes.io/name=python-app
              pod-template-hash=6b5bf7c796
Annotations:  <none>
Status:       Running
IP:           172.17.0.3
IPs:
  IP:           172.17.0.3
Controlled By:  ReplicaSet/python-app-6b5bf7c796
Containers:
  python-app:
    Container ID:   docker://d053885f70a71bd048040dd7a2e060c4323f5d9a252de41439051b10a277ff46
    Image:          boggda1337/moscow_app:latest
    Image ID:       docker-pullable://boggda1337/moscow_app@sha256:5f73d652973b5e18b3961ceb7fe397f7f376d00fadbd57c6ca73de102d422b31
    Port:           8000/TCP
    Host Port:      0/TCP
    State:          Running
      Started:      Mon, 14 Nov 2022 21:05:03 +0300
    Ready:          True
    Restart Count:  0
    Limits:
      cpu:     200m
      memory:  256Mi
    Requests:
      cpu:     100m
      memory:  128Mi
    Environment:
      MYSECRET:  <set to the key 'myprivatesecret' in secret 'secret'>  Optional: false
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-d49p6 (ro)
Conditions:
  Type              Status
  Initialized       True 
  Ready             True 
  ContainersReady   True 
  PodScheduled      True 
Volumes:
  kube-api-access-d49p6:
    Type:                    Projected (a volume that contains injected data from multiple sources)
    TokenExpirationSeconds:  3607
    ConfigMapName:           kube-root-ca.crt
    ConfigMapOptional:       <nil>
    DownwardAPI:             true
QoS Class:                   Burstable
Node-Selectors:              <none>
Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists for 300s
                             node.kubernetes.io/unreachable:NoExecute op=Exists for 300s
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  25s   default-scheduler  Successfully assigned default/python-app-6b5bf7c796-xh9gb to minikube
  Normal  Pulled     24s   kubelet            Container image "boggda1337/moscow_app:latest" already present on machine
  Normal  Created    24s   kubelet            Created container python-app
  Normal  Started    24s   kubelet            Started container python-app
```
