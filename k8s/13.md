# LAB 13

## kubectl get po,sts,svc,pvc
```
┌──(kali㉿kali)-[~]
└─$ minikube kubectl -- get pods,sts,svc,pvc                                         
NAME               READY   STATUS    RESTARTS   AGE
pod/python-app-0   1/1     Running   0          6m43s
pod/python-app-1   1/1     Running   0          6m41s
pod/python-app-2   1/1     Running   0          6m38s

NAME                          READY   AGE
statefulset.apps/python-app   3/3     6m43s

NAME                 TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)        AGE
service/kubernetes   ClusterIP      10.96.0.1       <none>        443/TCP        353d
service/python-app   LoadBalancer   10.103.118.35   <pending>     80:30299/TCP   6m43s

NAME                                                   STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
persistentvolumeclaim/persistent-volume-python-app-0   Bound    pvc-3227c41c-2a9d-4322-ae16-4fc6ee91eab8   128Mi      RWO            standard       6m43s
persistentvolumeclaim/persistent-volume-python-app-1   Bound    pvc-bc8f4838-b745-4519-a9b0-c697b65e1651   128Mi      RWO            standard       6m41s
persistentvolumeclaim/persistent-volume-python-app-2   Bound    pvc-dfe5efdd-edad-434b-87dc-159d5d670af3   128Mi      RWO            standard       6m38s

```

## Check the content of your file, in each pod
```
┌──(kali㉿kali)-[~]
└─$ minikube kubectl -- exec pod/python-app-0 -- cat /home/appuser/volume/visits.json
Accessed at: 19:20:43
Accessed at: 19:20:45
Accessed at: 19:20:46
Accessed at: 19:20:51
Accessed at: 19:20:51
                                                                                                                     
┌──(kali㉿kali)-[~]
└─$ minikube kubectl -- exec pod/python-app-1 -- cat /home/appuser/volume/visits.json
Accessed at: 19:20:34
Accessed at: 19:22:02
Accessed at: 19:22:03
Accessed at: 19:22:05
Accessed at: 19:22:06
Accessed at: 19:22:10
Accessed at: 19:22:10
                                                                                                                     
┌──(kali㉿kali)-[~]
└─$ minikube kubectl -- exec pod/python-app-2 -- cat /home/appuser/volume/visits.json
Accessed at: 19:22:09
Accessed at: 19:22:10
```

Each pod has its own mounted volume, so the number of times each pod is accessed depends on the load balancer, which decides which pod should handle the request.

## Ordering

In our case, the replicas are independent of each other.

To manage replicas in parallel:
```
podManagementPolicy: "Parallel"
```
